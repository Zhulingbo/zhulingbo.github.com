/**
 * Created by Peter.Ge
 * @version:2016.02.18
 */
(function(b,a){a["App"]={script:null,orient_change:null,$:function(c){var d=b.querySelectorAll(c);return d.length==1?d[0]:d},init:function(){this.script=App.$("#appjs")},fitScreen:function(){var g=b.documentElement,f=(g.attributes["data-dfs"])?g.attributes["data-dfs"].value:20,e=(g.attributes["data-dw"])?g.attributes["data-dw"].value:320,d="orientationchange" in a?"orientationchange":"resize",c=function(){var i=g.clientWidth;if(i){g.style.fontSize=f*(i/e)+"px"}if(typeof(a.App.orient_change)=="function"){var h=a.matchMedia("(orientation: portrait)");a.App.orient_change.apply(null,[!h.matches])}};if(!b.addEventListener){return}a.addEventListener(d,c,false);b.addEventListener("DOMContentLoaded",function(){c()},false)},setOrientChange:function(c){this.orient_change=c},get:function(f){var e=b.location.href.toString(),d=e.split("?"),h={};if(typeof(d[1])=="string"){d=d[1].split("&");for(var g in d){var c=d[g].split("=");h[c[0]]=c[1]}}return(f)?h[f]:h}};App.Audio=function(c,d){var e=this;this.options={src:d.src,icon_play_cls:d.icon_play_cls||"music",icon_stop_cls:d.icon_stop_cls||"music music_close",ended:d.ended||null,autoplay:d.autoplay||false,loop:d.loop||false};this.icon=App.$(c);console.log(this.icon.length);console.log(this.icon.size);if(!this.icon){throw"music icon is not exists"}this.beep=b.createElement("audio");this.beep.setAttribute("src",this.options["src"]);if(this.options["loop"]){this.beep.setAttribute("loop","loop")}if(e.options["autoplay"]){this.beep.setAttribute("autoplay",true);this.beep.addEventListener("loadeddata",function(){this.play()});this.icon.setAttribute("class",this.options["icon_play_cls"])}else{this.icon.setAttribute("class",this.options["icon_stop_cls"])}this.icon.addEventListener("touchend",function(){if(e.beep.paused){e.play();e.icon.setAttribute("class",e.options["icon_play_cls"])}else{e.pause();e.icon.setAttribute("class",e.options["icon_stop_cls"])}});this.beep.addEventListener("ended",function(){e.icon.setAttribute("class",e.options["icon_stop_cls"]);if(e.options["ended"]&&typeof(e.options["ended"])=="function"){e.options["ended"].call()}});this.beep.load()};App.Audio.prototype.play=function(){this.beep.play()};App.Audio.prototype.pause=function(){this.beep.pause()};App.init();if(App.script.getAttribute("data-adapt")==1){App.fitScreen()}})(document,window);